{{> header}}
<div ng-app="EduDevPlan" ng-controller="mainController" data-ng-init="init()">
    <div role="main" class="main">
        <section class="page-top none-margin">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <ul class="breadcrumb">
                            <li class="active">ระบบจัดการข้อมูลเบื้องหลัง</li>
                        </ul>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <h1 class="none-padding">ระบบจัดการด้านแผนพัฒนาการศึกษาระดับอุดมศึกษา</h1>
                    </div>
                </div>
            </div>
        </section>
        <hr class="tall dashboard">
        <div class="sort-source-wrapper"><!-- button action on header -->
            <div class="container">
                <ul data-option-key="filter" data-sort-id="portfolio" class="nav nav-pills sort-source menu-top pull-right">
                    <li class="active">
                        <button ng-click="pageIssueAndTarget()" ng-show="pageLevel==2" class="btn btn-default back"><i class="fa fa-angle-double-left"> ย้อนกลับ</i></button>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <div class="form-group">
                    <label class="col-md-4 control-label">ปีงบประมาณ</label>
                    <div class="col-md-8">
                        <select ng-model="selectYear" ng-init="selectYear = 'udf'" ng-change="fetchIssueAndTarget()" ng-disabled="pageLevel==2" class="form-control input-sm">
                            <option value="udf">- เลือกปีงบประมาณ -</option>
                            <option ng-repeat="list in cmDataListYear" value="{[list.year]}">{[list.year]}</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <label class="col-md-4 control-label">แผนกลยุทธ์</label>
                    <div class="col-md-8">
                        <select ng-model="selectType" ng-init="selectType = 'udf'" ng-change="fetchIssueAndTarget()" ng-disabled="pageLevel==2" class="form-control input-sm">
                            <option value="udf">- เลือกแผนกลยุทธ์ -</option>
                            <option ng-repeat="mpt in dataType | orderBy:'id'" value="{[mpt.id]}">{[ mpt.planTypeName ]}</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">


            <div class="col-md-12" ng-show="pageLevel==1"> 
                <div class="form-group"> <br>
                    <label id="label-level" class="col-md-2 control-label"></label>   
                    <div class="col-md-10">         
                        <button ng-click="modal('add','issue')" ng-show="selectType!='udf'" class="btn btn-success add pull-right control-label"><i class="fa fa-plus-circle"></i> ประเด็นยุทธศาสตร์</button>      
                    </div>  
                </div>
            </div>
            
            <div class="col-sm-12" ng-show="pageLevel==2"> <br>
                <div class="row"><div class="col-sm-12" style="font-weight: bold;">ประเด็นยุทธศาสตร์ : {[issueLabel]}</div></div>
                <div class="row"><div class="col-sm-1"></div><div class="col-sm-11">เป้าประสงค์ : {[targetLabel]}</div></div>
                <div class="form-group"> <br>
                    <div class="col-sm-6">         
                        <button ng-click="modal('add','kpi')" class="btn btn-success add pull-right control-label"><i class="fa fa-plus-circle"></i> ตัวชี้วัด</button>      
                    </div>
                    <div class="col-sm-6">         
                        <button ng-click="modal('add','strategy')" class="btn btn-success add pull-right control-label"><i class="fa fa-plus-circle"></i> กลยุทธ์</button>      
                    </div>  
                </div>
            </div>


        </div>
        <br>
        <div class="row" ng-show="pageLevel==1">
            <div id="formHome" class="col-md-12">
                <div id="bidderTable" class="col-md-12"><!-- table shown bidder information list -->


                    <table class="table table-bordered table-condensed mb-none">
                        <thead>
                            <tr>
                                <th class="text-center col-lg-1">ลำดับ</th>
                                <th class="text-center col-lg-7">ประเด็นยุทธศาสตร์ / เป้าประสงค์</th>
                                <th class="text-center col-lg-4">จัดการ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-show="selectYear=='udf' || selectType=='udf'">
                                <td colspan="3" class="text-center" style="background-color: #f9f9f9">กรุณาเลือกปีงบประมาณและแผนกลยุทธ์</td>
                            </tr>
                            <tr ng-show="selectYear!='udf' && selectType!='udf' && dataIssueAndTarget==null">
                                <td colspan="3" class="text-center" style="background-color: #f9f9f9">ไม่พบข้อมูล</td>
                            </tr>
                            <tr ng-show="selectYear!='udf' && selectType!='udf'" ng-repeat-start="list in dataIssueAndTarget">   
                                <td class="text-center">{[$index+1]}</td> 
                                <td>{[list.nameIssue]}</td>   
                                <td class="text-center">
                                    <button ng-click="modal('add','target',null,null,$index,list.idIssue)" class="btn btn-success""><i class="fa fa-plus-circle"></i> เป้าประสงค์</button> 
                                    <button ng-click="modal('edit','issue',list.idIssue,list.nameIssue)" class="btn btn-warning"><i class="fa fa-pencil"></i> แก้ไข</button>    
                                    <button ng-click="delData('issue',list.idIssue)" class="btn btn-default""><i class="fa fa-trash-o "></i> ลบ</button> 
                                </td>
                            </tr>

                            <tr ng-show="selectYear!='udf' && selectType!='udf'" ng-repeat="listT in list.target" style="background-color:#F1F1F1;">   
                                <td class="text-center">
                                </td> 
                                <td> 
                                    <div class="row">
                                        <div class="col-sm-1">{[$parent.$index+1]}.{[$index+1]}</div>
                                        <div class="col-sm-11">{[listT.nameTarget]}</div>
                                    </div> 
                                </td>   
                                <td class="text-center">
                                    <button ng-click="pageKpiAndStrategy(listT.idTarget,list.nameIssue,listT.nameTarget)" class="btn btn-primary""><i class="fa fa-cog"></i> ตัวชี้วัด / กลยุทธ์</button> 
                                    <button ng-click="modal('edit','target',listT.idTarget,listT.nameTarget,$parent.$index)" class="btn btn-warning"><i class="fa fa-pencil"></i> แก้ไข</button>    
                                    <button ng-click="delData('target',listT.idTarget,$parent.$index)" class="btn btn-default"><i class="fa fa-trash-o "></i> ลบ</button> 
                                </td>
                            </tr>

                            <tr ng-show="0" ng-repeat-end><td>repeat end</td></tr>
  
                        </tbody>
                    </table>

                </div>
            </div>
        </div>


        <div class="row" ng-show="pageLevel==2">
            <div class="col-sm-6">
                <table class="table table-bordered table-condensed mb-none">
                    <thead>
                        <tr>
                            <th class="text-center col-lg-1">ลำดับ</th>
                            <th class="text-center col-lg-7">ตัวชี้วัด</th>
                            <th class="text-center col-lg-4">จัดการ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-show="dataKpi.length==0">
                            <td colspan="3" class="text-center" style="background-color: #f9f9f9">ไม่พบข้อมูล</td>
                        </tr>
                        <tr ng-repeat="list in dataKpi | orderBy:'id'">   
                            <td class="text-center">{[$index+1]}</td> 
                            <td>{[list.kpiName]}</td>   
                            <td class="text-center">
                                <button ng-click="modal('edit','kpi',list.id,list.kpiName)" class="btn btn-warning"><i class="fa fa-pencil"></i> แก้ไข</button>    
                                <button ng-click="delData('kpi',list.id)" class="btn btn-default""><i class="fa fa-trash-o "></i> ลบ</button> 
                            </td>
                        </tr>

                    </tbody>
                </table>
            </div>
            <div class="col-sm-6">
                <table class="table table-bordered table-condensed mb-none">
                    <thead>
                        <tr>
                            <th class="text-center col-lg-1">ลำดับ</th>
                            <th class="text-center col-lg-7">กลยุทธ์</th>
                            <th class="text-center col-lg-4">จัดการ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-show="dataStrategy.length==0">
                            <td colspan="3" class="text-center" style="background-color: #f9f9f9">ไม่พบข้อมูล</td>
                        </tr>
                        <tr ng-repeat="list in dataStrategy | orderBy:'id'">   
                            <td class="text-center">{[$index+1]}</td> 
                            <td>{[list.strategyName]}</td>   
                            <td class="text-center">
                                <button ng-click="modal('edit','strategy',list.id,list.strategyName)" class="btn btn-warning"><i class="fa fa-pencil"></i> แก้ไข</button>    
                                <button ng-click="delData('strategy',list.id)" class="btn btn-default""><i class="fa fa-trash-o "></i> ลบ</button> 
                            </td>
                        </tr>

                    </tbody>
                </table>
            </div>
        </div>


        

    </div><!--  container  -->
    
    
    <div id="modal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header"> 
                    <button data-dismiss="modal" class="close" type="button"></button>  
                    <h4 class="modal-title">
                        <i ng-show="action == 'add'" class="fa fa-plus-circle"></i>
                        <span ng-show="action == 'add'">เพิ่ม</span>
                        <i ng-show="action == 'edit'" class="fa fa-pencil"></i>
                        <span ng-show="action == 'edit'">แก้ไข</span>
                        <span ng-show="type == 'issue'">ประเด็นยุทธศาสตร์</span>
                        <span ng-show="type == 'target'">เป้าประสงค์</span>
                        <span ng-show="type == 'kpi'">ตัวชี้วัด</span>
                        <span ng-show="type == 'strategy'">กลยุทธ์</span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="col-md-12">   
                        <div class="form-group" ng-class="">      
                            <textarea ng-model="textName" class="form-control" rows="3"></textarea> 
                        </div>  
                    </div>
                    <br><br>
                </div>
                <br><br>
                <div class="modal-footer">  
                    <button data-dismiss="modal" class="btn btn-default" type="button">ยกเลิก</button> 
                    <button ng-click="saveData()" class="btn btn-success" type="button" >บันทึก</button>
                </div>
            </div>
        </div>
    </div>
    
    
</div>




{{> footer}}
<script src="{{_context_path}}/apps/bginfo/views/EduDevPlan/js/manage.js"></script>
